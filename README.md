# llm-chatlog

Claude와 ChatGPT의 대화를 안전하게 저장하는 Chrome 확장 프로그램입니다. 서버로 데이터를 전송하지 않고 완전히 로컬에서 작동하므로, 민감한 대화 내용도 안심하고 저장할 수 있습니다.

## 프로젝트 구조

이 프로젝트는 여러 버전의 확장 프로그램을 포함하고 있습니다:

```
llm-chatlog/
├── llm-chat-logger/        # v4.0.0 (최신 통합 버전) ⭐
├── claude-chat-logger/     # v2.11 (구버전 - Claude 전용)
├── gpt-chat-logger/        # v1.0.4 (테스트 버전 - ChatGPT 전용)
└── _sample/                # 저장 파일 예시
```

**llm-chat-logger v4.0.0**을 사용하시면 Claude와 ChatGPT를 모두 지원합니다. 이전 버전들은 레거시 또는 테스트 목적으로 보관되어 있습니다.

## 사용방법

### Chrome 확장 프로그램 설치하기

Chrome에 확장 프로그램을 설치하는 과정은 다음과 같습니다:

1. **Chrome 확장 프로그램 페이지 열기**: 주소창에 `chrome://extensions/`를 입력하거나, Chrome 메뉴 > 도구 더보기 > 확장 프로그램을 선택합니다.

2. **개발자 모드 활성화**: 페이지 우측 상단의 "개발자 모드" 토글을 켜서 활성화합니다. 이렇게 하면 공식 스토어가 아닌 로컬 폴더에서도 확장 프로그램을 로드할 수 있습니다.

3. **확장 프로그램 로드**: "압축해제된 확장 프로그램을 로드합니다" 버튼을 클릭한 후, 다운로드한 `llm-chat-logger` 폴더를 선택합니다.

4. **설치 확인**: 확장 프로그램 목록에 "LLM Chat Logger"가 나타나면 설치가 완료된 것입니다.

### 대화 저장하기

설치가 완료되면 Claude.ai나 ChatGPT.com에서 대화를 저장할 수 있습니다:

- **Windows 사용자**: `Ctrl + S` 키를 누르면 현재 대화가 저장됩니다.
- **Mac 사용자**: `Cmd + S` 키를 누르면 현재 대화가 저장됩니다.

저장 시 브라우저의 다운로드 폴더에 자동으로 2개의 파일이 생성됩니다. 파일명에는 날짜와 대화 키워드가 포함되어 나중에 찾기 쉽습니다.

### 디버그 모드 사용하기

문제가 발생했을 때 디버그 모드를 켜면 상세한 로그를 확인할 수 있습니다:

- **Windows**: `Ctrl + Shift + D`
- **Mac**: `Cmd + Shift + D`

디버그 모드를 켠 후 F12를 눌러 개발자 도구의 Console 탭에서 로그를 확인하세요.

## 특징

### 두 가지 형식으로 동시 저장

이 확장 프로그램은 한 번의 저장으로 2개의 파일을 생성합니다. 각 파일은 서로 다른 용도로 최적화되어 있습니다:

**전체 대화 파일 (`_full_v4.0.0.md`)**은 AI의 사고 과정(Thinking)을 포함한 모든 내용을 담고 있습니다. 나중에 대화의 전체 맥락을 이해하거나, AI가 어떻게 답변을 도출했는지 분석할 때 유용합니다.

**질문 요약 파일 (`_questions_v4.0.0.md`)**은 사용자의 질문만 간단히 정리한 버전입니다. 다른 대화에서 프롬프트를 재사용 하거나 맥락을 주입할 때 편리합니다.

### 저장되는 마크다운 형식

대화는 다음과 같은 구조적인 마크다운 형식으로 저장됩니다:

```markdown
# Q1. 사용자의 첫 번째 질문... ❓

## 👤 Human: ❓
    여기에 사용자가 입력한 전체 질문이 들어갑니다.
    들여쓰기로 구분되어 읽기 편합니다.

## 🤖 Claude/ChatGPT:

### 💭 Thinking:
    AI가 답변을 생성하기 전에 거친 사고 과정이 기록됩니다.
    (ChatGPT는 이 섹션이 없을 수 있습니다)

### 💬 Answer:
    실제 AI의 답변 내용이 여기에 포함됩니다.
    코드, 표, 리스트 등 모든 서식이 보존됩니다.
```

### 대화의 연속성 유지

저장된 마크다운 파일은 다른 AI 대화에서 그대로 활용할 수 있습니다. 이전 대화 내용을 새 대화창에 복사하여 붙여넣으면, AI가 이전 맥락을 이해하고 대화를 이어갈 수 있습니다. 프로젝트를 진행하면서 단계별로 대화를 저장해두면, 나중에 전체 진행 과정을 문서로 정리하기도 쉽습니다.

### 완벽한 로컬 보안

이 확장 프로그램은 외부 서버와 통신하지 않습니다. 모든 처리가 사용자의 브라우저 내에서만 이루어지므로, 회사 기밀이나 개인적인 대화 내용이 유출될 걱정이 없습니다. 코드는 완전히 공개되어 있어 누구나 검증할 수 있습니다.

## 상세 기술 설명

### content.js - 핵심 동작 원리

확장 프로그램의 메인 로직은 content.js 파일에 구현되어 있습니다. 사용자가 저장 단축키를 누르면 다음과 같은 순서로 처리됩니다:

```
사용자가 Cmd/Ctrl+S 입력
        ↓
현재 사이트 감지 (Claude인지 ChatGPT인지)
        ↓
플랫폼별 추출 방식 적용
├─→ Claude: 순차적 div 패턴 분석
└─→ ChatGPT: data-testid 속성 활용
        ↓
대화 내용에서 키워드 추출 및 제목 생성
        ↓
HTML을 마크다운으로 변환
        ↓
2개 파일로 저장 (전체 버전 + 요약 버전)
```

### 주요 함수 설명

**사이트 감지 함수 (`detectCurrentSite`)**는 현재 웹페이지의 URL을 확인하여 Claude.ai인지 ChatGPT.com인지 자동으로 판별합니다. 각 사이트는 DOM 구조가 다르기 때문에 이 단계가 필수적입니다.

**대화 추출 함수 (`extractConversation`)**는 감지된 플랫폼에 맞는 추출 방식을 적용합니다. DOM Tree를 분석하여 사이트별로 다르게 적용됩니다.

**제목 생성 함수 (`generateTitle`)**는 먼저 브라우저 탭의 제목을 확인합니다. 탭 제목이 일반적인 경우에는 대화 내용에서 중요한 키워드를 추출하여 파일명을 만듭니다. 한국어와 영어를 모두 지원합니다.

**마크다운 변환 함수 (`convertToMarkdownFull`)**는 HTML 요소를 마크다운 문법으로 변환합니다. 제목, 리스트, 코드 블록, 표 등 다양한 요소를 정확하게 변환하여 원본 서식을 최대한 보존합니다.

### sites.js - 플랫폼별 설정

각 플랫폼의 DOM 구조와 추출 규칙을 정의합니다:

```javascript
claude: {
  // Claude는 대화가 순차적 div 쌍으로 구성
  pattern: { type: 'sequential-pairs' },
  // Thinking 블록을 감지하는 특별한 클래스
  extraction: { thinking: { containerSelector: '.transition-all...' } }
}

chatgpt: {
  // ChatGPT는 data-testid로 메시지 구분
  pattern: { type: 'data-testid' },
  // 한국어 인터페이스 지원
  messageIndicator: '.sr-only',
  userText: '나의 말:',
  assistantText: 'ChatGPT의 말:'
}
```

### keywords.js - 한국어 처리 엔진 (🚧 Work in progress 🚧)

한국어 키워드 추출을 위한 처리 로직이 포함되어 있습니다. 불필요한 조사를 제거하고, 동사와 형용사의 어미를 정규화하여 의미 있는 키워드만 추출합니다. 이를 통해 "확장프로그램을 만들어줘"라는 문장에서 "확장프로그램 만들다"와 같은 핵심 키워드를 뽑아낼 수 있습니다.
아직 개선작업중이라서, 지금은 자동생성된 채팅방 제목을 파일명으로 이용하고, 파일 상단에 15개의 상위키워드와 원본 대화링크를 포함하도록 하였습니다.
저장된 마크다운을 드라이브에 넣고 MCP나 CLI를 이용하면 편하게 수정할 수 있는 대체적인 방법이 있어서 이 기능은 좀더 천천히 보강하도록 하겠습니다..


## 문제 해결 가이드

**저장이 작동하지 않을 때**: 먼저 올바른 사이트(claude.ai 또는 chatgpt.com)에 있는지 확인하세요. 그래도 문제가 있다면 디버그 모드를 켜고 콘솔 로그를 확인하여 에러 메시지를 찾아보세요.

**DOM 구조 변경 알림**: Claude나 ChatGPT가 인터페이스를 업데이트하면 추출이 실패할 수 있습니다. 이런 경우 GitHub Issues에 보고해 주시면 빠르게 업데이트하겠습니다.


---

## Version History

### v4.0.0 (2025-01-20) - 현재 최신 버전 ⭐

Claude와 ChatGPT를 하나의 확장 프로그램으로 통합한 메이저 업데이트입니다. 기존에 분리되어 있던 gpt-chat-logger v1.0.4의 기능을 병합하여, 사용자가 플랫폼별로 다른 확장 프로그램을 설치할 필요가 없어졌습니다.

### 개발 과정의 주요 버전들

**v3.1.11**에서는 브라우저 탭 제목을 파일명으로 우선 사용하도록 개선했습니다. 이전에는 대화 내용에서만 키워드를 추출했지만, 많은 경우 탭 제목이 더 명확한 정보를 담고 있다는 것을 발견했습니다.

**v3.1.9**는 마크다운 변환의 정확도를 크게 향상시킨 버전입니다. DOM을 수정하지 않고 2단계로 처리하는 방식을 도입하여 콘텐츠 순서가 뒤바뀌는 문제를 해결했습니다.

**v3.0.1**에서는 사용자 아바타 이미지가 텍스트로 변환되는 문제를 수정하고, Q&A 제목의 중복을 제거했습니다.

### 파생 프로젝트

**gpt-chat-logger v1.0.4**는 ChatGPT 지원을 위해 별도로 개발된 테스트 버전이었습니다. ChatGPT의 독특한 DOM 구조를 분석하고 안정적인 추출 방법을 찾은 후, v4.0.0에 통합되었습니다.

**claude-chat-logger v2.11**은 초기의 안정적인 Claude 전용 버전입니다. 단일 파일 구조로 단순하지만 견고하게 작동하며, 현재도 Claude만 사용하는 분들을 위해 유지되고 있습니다.



